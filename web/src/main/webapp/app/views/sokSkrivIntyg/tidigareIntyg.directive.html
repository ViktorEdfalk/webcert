<!-- Tidigare intyg table -->
<div ng-if="!viewState.loadErrorMessageKey" class="wc-patient-icon-gutter">
  <i class="icon-wc-ikon-24 gutter-icon icon-wc-32"></i>
  <h2 class="patient-intyg-heading">Tidigare intyg</h2>

  <div class="inline-block">
    <div class="form-group text-right">
      <label class="radio-inline">
        <input id="intygFilterAktuella" name="intygFilter" type="radio" value="current"
               ng-model="viewState.intygFilter" checked="checked"> Aktuella intyg
      </label>
      <label class="radio-inline">
        <input id="intygFilterRattade" name="intygFilter" type="radio" value="revoked"
               ng-model="viewState.intygFilter" checked="checked"> Ersatta, makulerade och kompletterade intyg
      </label>
      <label class="radio-inline">
        <input id="intygFilterSamtliga" name="intygFilter" type="radio" value="all"
               ng-model="viewState.intygFilter" checked="checked"> Alla intyg
      </label>
    </div>

    <div wc-spinner label="info.loadingdata" show-spinner="viewState.tidigareIntygLoading"
         show-content="!viewState.tidigareIntygLoading">
      <div id="intygLista">

        <!-- No intyg for person -->
        <div id="current-list-noResults-unit"
             ng-show="!viewState.intygListErrorMessageKey && viewState.currentList.length < 1">
          <span message key="info.nointygfound"></span>
        </div>

        <!-- error message -->
        <wc-alert-message ng-show="viewState.intygListErrorMessageKey"
                          alert-message-id="{{viewState.intygListErrorMessageKey}}"
                          alert-severity="danger"
                          id="current-list-noResults-error"></wc-alert-message>
        <wc-alert-message ng-show="viewState.inlineErrorMessageKey"
                          alert-message-id="{{viewState.inlineErrorMessageKey}}"
                          alert-severity="danger"></wc-alert-message>

        <!-- Previous intyg table -->
        <div class="row" ng-show="viewState.currentList.length>0" id="prevIntygTable">
          <table class="col-md-12 table table-striped wc-table-striped">
            <tr>
              <th></th>
              <th ng-if="!patientModel.avliden"></th>
              <th wc-table-head label-key="th.label.intyg-type" help-key="th.help.intyg-type"></th>
              <th wc-table-head label-key="th.label.status" help-key="th.help.status"></th>
              <th wc-table-head label-key="th.label.saved-date" help-key="th.help.saved-date"></th>
              <th wc-table-head label-key="th.label.saved-signed-by" help-key="th.help.saved-signed-by"></th>
            </tr>
            <tr ng-repeat="intyg in viewState.currentList">
              <td>
                <button type="button"
                        id="showBtn-{{intyg.intygId}}"
                        class="btn btn-secondary"
                        ng-click="openIntyg(intyg)"
                        uib-popover="{{messageService.getProperty('common.show.tooltip')}}"
                        popover-trigger="mouseenter"
                        popover-popup-delay="300"
                        popover-append-to-body="true"
                        popover-placement="auto top">
                  {{messageService.getProperty('common.show')}}
                </button>
              </td>
              <td ng-if="!patientModel.avliden">
                <button type="button"
                        wc-authority="FORNYA_INTYG"
                        feature="FORNYA_INTYG"
                        intygstyp="{{intyg.intygType}}"
                        id="fornyaBtn-{{intyg.intygId}}"
                        class="btn btn-secondary"
                        ng-if="isRenewalAllowed(intyg)"
                        ng-click="fornyaIntyg(intyg)"
                        uib-popover="{{ resolveTooltipText(intyg) }}"
                        popover-trigger="mouseenter"
                        popover-popup-delay="300"
                        popover-append-to-body="true"
                        popover-placement="auto top">
                  {{messageService.getProperty('common.fornya')}}
                </button>
              </td>
              <td>{{getTypeName(intyg.intygType)}}</td>
              <td class="unbreakable"><span message key="intyg.status.{{intyg.status}}"></span></td>
              <td class="unbreakable">{{intyg.lastUpdatedSigned | date:'short'}}</td>
              <td class="unbreakable wc-table-striped-last">{{intyg.updatedSignedBy}}</td>
            </tr>
          </table>

        </div>
        <span class="{{viewState.unsigned}}"></span>
      </div>

    </div>
  </div>
  <!-- spinner tidigare intyg end -->
</div>
