
<!-- Tidigare intyg table -->

<div>
  <div class="wc-patient-icon-gutter sok-skriv-gutter">
    <i class="icon-wc-ikon-24 gutter-icon icon-wc-32"></i>
    <h2 class="patient-intyg-heading">Tidigare intyg</h2>

    <div class="inline-block">
      <div class="form-group">
        <wc-radio-wrapper>
          <input id="intygFilterAktuella" name="intygFilter" type="radio" value="current"
                 ng-model="viewState.intygFilter" checked="checked">
          <label for="intygFilterAktuella">Aktuella intyg</label>
        </wc-radio-wrapper>
        <wc-radio-wrapper>
          <input id="intygFilterRattade" name="intygFilter" type="radio" value="revoked"
                 ng-model="viewState.intygFilter" checked="checked">
          <label for="intygFilterRattade">Ersatta, makulerade, l√•sta och kompletterade intyg
          </label>
        </wc-radio-wrapper>
        <wc-radio-wrapper>
          <input id="intygFilterSamtliga" name="intygFilter" type="radio" value="all" ng-model="viewState.intygFilter"
                 checked="checked">
          <label for="intygFilterSamtliga">Alla intyg
          </label>
        </wc-radio-wrapper>
      </div>

      <wc-spinner label="info.loadingdata" show-spinner="viewState.tidigareIntygLoading">
        <div id="intygLista">

          <!-- error message -->

          <wc-alert-message ng-show="viewState.intygListErrorMessageKey"
                            alert-message-id="{{viewState.intygListErrorMessageKey}}"
                            alert-severity="danger"
                            id="current-list-noResults-error"></wc-alert-message>
          <wc-alert-message ng-show="viewState.inlineErrorMessageKey"
                            alert-message-id="{{viewState.inlineErrorMessageKey}}"
                            alert-severity="danger"></wc-alert-message>

          <!-- Previous intyg table -->
          
          <div class="row" ng-show="viewState.currentList.length>0" id="prevIntygTable">
            <div class="col-md-12">
              <div class="rounded-table-wrapper">
              <table class="table table-striped wc-table-striped">
                <thead>
                   <tr>
                    <th wc-table-head label-key="th.label.intyg-type" help-key="th.help.intyg-type"></th>
                    <th wc-table-head label-key="th.label.status" help-key="th.help.status"></th>
                    <th wc-table-head label-key="th.label.saved-date" help-key="th.help.saved-date"></th>
                    <th wc-table-head label-key="th.label.saved-signed-by" help-key="th.help.saved-signed-by"></th>
                    <th ng-if="!patientModel.avliden"></th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat="intyg in viewState.currentList">
                    <td>{{getTypeName(intyg.intygType)}}</td>
                    <td class="unbreakable"><span dynamic-label key="intyg.status.{{intyg.status}}"></span></td>
                    <td class="unbreakable">{{intyg.lastUpdatedSigned | date:'short'}}</td>
                    <td class="unbreakable">{{intyg.updatedSignedBy}}</td>
                    <td ng-if="!patientModel.avliden">
                      <button type="button"
                              wc-authority="FORNYA_INTYG"
                              feature="FORNYA_INTYG"
                              intygstyp="{{intyg.intygType}}"
                              id="fornyaBtn-{{intyg.intygId}}"
                              class="btn btn-primary"
                              ng-if="isRenewalAllowed(intyg)"
                              ng-click="fornyaIntygBtnPopOver=false;fornyaIntyg(intyg)"
                              uib-popover="{{ resolveTooltipText(intyg) }}"
                              popover-trigger="mouseenter"
                              popover-popup-delay="300"
                              popover-append-to-body="true"
                              popover-placement="auto top"
                              popover-is-open="fornyaIntygBtnPopOver">
                        <i class="material-icons">autorenew</i> {{messageService.getProperty('common.fornya')}}
                      </button>
                    </td>
                    <td>
                      <button type="button"
                              id="showBtn-{{intyg.intygId}}"
                              class="btn btn-primary"
                              ng-click="openIntyg(intyg)"
                              uib-popover="{{messageService.getProperty('common.show.tooltip')}}"
                              popover-trigger="mouseenter"
                              popover-popup-delay="300"
                              popover-append-to-body="true"
                              popover-placement="auto top">
                        <i class="icon-wc-ikon-19"></i> {{messageService.getProperty('common.open')}}
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
          </div>
        </div>
          </div>
          <span class="{{viewState.unsigned}}"></span>
        </div>

      </wc-spinner>
    </div>
    <!-- spinner tidigare intyg end -->
  </div>
</div>
