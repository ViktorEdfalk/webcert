<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://www.springframework.org/schema/beans" xmlns:jdbc="http://www.springframework.org/schema/jdbc"
  xmlns:jpa="http://www.springframework.org/schema/data/jpa"
  xmlns:context="http://www.springframework.org/schema/context"
  xmlns:tx="http://www.springframework.org/schema/tx"
  xsi:schemaLocation="
       http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
       http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd"
       profile="import">

  <context:annotation-config />
  
  <tx:annotation-driven />
  
  <bean id="webcertDao" class="se.inera.certificate.mc2wc.jpa.webcert.WebcertDAO" />

  <bean id="webcertTransactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="webcertEntityManagerFactory" />
  </bean>

  <bean id="webcertEntityManagerFactory"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="webcertDataSource" />
    <property name="persistenceUnitName" value="jpa.webcert" />
    <property name="jpaVendorAdapter">
      <bean
        class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
        <property name="database" value="${webcert.database.type}" />
      </bean>
    </property>
  </bean>

  <bean id="webcertDataSource" class="org.apache.commons.dbcp.BasicDataSource"
    destroy-method="close">
    <property name="driverClassName" value="${webcert.database.driver}" />
    <property name="url" value="${webcert.database.url}" />
    <property name="username" value="${webcert.database.user}" />
    <property name="password" value="${webcert.database.pwd}" />
  </bean>
  
  <beans profile="import-unittest">
    <bean id="liquibase" class="liquibase.integration.spring.SpringLiquibase">
      <property name="dataSource" ref="webcertDataSource" />
      <property name="changeLog" value="classpath:/changelog/changelog.xml" />
    </bean>
  </beans>

</beans>