!2 VIKTIGT
!3 För att kunna köra omsändningstester behöver Webcert konfigureras enl. följande:
!4 Webcert skall startas med konfigurationsfil 'webcert-dev-itstub.properties':
    
    -Dwebcert.config.file=/Users/eriklupander/intyg/webcert/web/webcert-dev-itstub.properties

!4 ActiveMQ-inställningar för omsändning behöver omkonfigureras. För körning i "utvecklingsmiljö" på Jetty, öppna jetty-web.xml och ändra AMQ-URL till följande under AsyncConnectionFactory:

    vm://localhost?broker.persistent=false&amp;jms.nonBlockingRedelivery=true&amp;jms.redeliveryPolicy.maximumRedeliveries=25&amp;jms.redeliveryPolicy.maximumRedeliveryDelay=60000&amp;jms.redeliveryPolicy.initialRedeliveryDelay=2000&amp;jms.redeliveryPolicy.useExponentialBackOff=true&amp;jms.redeliveryPolicy.backOffMultiplier=2

!3 Stäng ner stubben
| script | !-SokSkrivIntyg-! |
| intygstjanst stub offline |

!3 Lägg till komplett utkast

| skapa utkast |
| intygId | intygTyp | patientPersonnummer | patientFornamn | patientEfternamn | hsaId | namn | enhetId | komplett | kodverk |
| webcert-fitnesse-signera-1 | fk7263 | 19121212-1212 | Test | Testorsson | IFV1239877878-104B | Åsa Andersson | IFV1239877878-1042 | ja | ICD_10_SE |
| webcert-fitnesse-signera-2 | ts-bas | 19000101-9801 | Test | Testorsson | IFV1239877878-104N | Åsa Andersson | IFV1239877878-1045 | ja | |
| webcert-fitnesse-signera-3 | ts-diabetes | 19000101-9801 | Test | Testorsson | IFV1239877878-104N | Åsa Andersson | IFV1239877878-1045 | ja | |


!3 Logga in

!|script     |!-LoggaIn-!                          |
|logga in som|IFV1239877878-104B_IFV1239877878-1042|

!3 Signera utkasten

| Signera Utkast |
| intygId | intygTyp | version |
| webcert-fitnesse-signera-1 | fk7263 | 2 |

| Signera Utkast |
| intygId | intygTyp | version |
| webcert-fitnesse-signera-2 | ts-bas | 2 |

| Signera Utkast |
| intygId | intygTyp | version |
| webcert-fitnesse-signera-3 | ts-diabetes | 2 |



!3 Aktivera stubben
| script | !-SokSkrivIntyg-! |
| intygstjanst stub online |

!3 Verifiera att Intygstjänsten tagit emot intygen (asynkron sändning, webcert-1314)
| script | !-IntygstjanstAsynk-! |
| finns intyg i stub med | webcert-fitnesse-signera-1 | vantetid | 60000 |
| finns intyg i stub med | webcert-fitnesse-signera-2 | vantetid | 60000 |
| finns intyg i stub med | webcert-fitnesse-signera-3 | vantetid | 60000 |





!3 Ta bort utkast

| ta bort utkast |
| utkastId |
| webcert-fitnesse-signera-1 |
| webcert-fitnesse-signera-2 |
| webcert-fitnesse-signera-3 |
